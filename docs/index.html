<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>awsrun API documentation</title>
<meta name="description" content="CLI and library to concurrently execute user-defined commands across AWS accounts â€¦" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css" rel="stylesheet">
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<!-- <link href="/awsrun/webfonts.css" rel="stylesheet"> -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Roboto:ital,wght@0,300;0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
<style>
body {
font-size: 16px;
font-family: 'Roboto', sans-serif;
}
code {
font-family: 'Roboto Mono', monospace;
}
#content {
max-width: 100ch;
}
/* `Text` size and code in main body text */
section code {
font-size: 14px;
}
/* Line height for blocks of code in main text */
pre code {
font-size: 13px;
line-height: 1.35em;
}
/* "expand source code" text */
details {
font-size: 12px;
}
/* Code block in the expand source section */
.source pre code {
font-size: 12px;
line-height: 1.35em;
}
/* Navbar code */
ul li code a {
font-size: 14px;
}
/* Used in method names sections etc .. */
code.name {
font-size: 14px;
}
.title code {
font-family: 'Roboto', sans-serif;
}
dt {
font-weight: bold;
}
h1 {
font-size: 2.0em;
}
</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>awsrun</code></h1>
</header>
<section id="section-intro">
<p>CLI and library to concurrently execute user-defined commands across AWS accounts.</p>
<h2 id="overview">Overview</h2>
<p><code><a title="awsrun" href="#awsrun">awsrun</a></code> is both a CLI and library to execute commands over one or more AWS
accounts concurrently. Commands are user-defined Python modules that implement a
simple interface to abstract away the complications of obtaining credentials for
Boto3 sessions - especially when using SAML authentication and/or cross-account
access.</p>
<h3 id="cli-usage">CLI Usage</h3>
<p>The awsrun CLI command is documented extensively on the <code><a title="awsrun.cli" href="cli.html">awsrun.cli</a></code> page. It
includes both a user guide as well as a reference guide on the use of the CLI
command, its command line options, use of the account loader and credential
plug-ins, as well as the syntax of the configuration file.</p>
<h3 id="library-usage">Library Usage</h3>
<p>Not only is awsrun a CLI, but it is, first and foremost, a Python package that
can be used in other Python libraries and scripts. The package contains
extensive documentation on its use. Each submodule contains an overview of the
module and how to use it, which is then followed by standard module docs for
classes and methods. The available <a href="#header-submodules">submodules</a> can be found
at the bottom of this page. Of particular interest to library users will be the
following submodules:</p>
<dl>
<dt><code><a title="awsrun.runner" href="runner.html">awsrun.runner</a></code></dt>
<dd>The core module to execute a command across one or more accounts. You will
find the <code><a title="awsrun.runner.AccountRunner" href="runner.html#awsrun.runner.AccountRunner">AccountRunner</a></code> and <code><a title="awsrun.runner.Command" href="runner.html#awsrun.runner.Command">Command</a></code> classes
defined in this module. Build your own commands by subclassing the base class.
See the <a href="#user-defined-commands">User-Defined Commmands</a> next for more
information.</dd>
<dt><code><a title="awsrun.session" href="session/index.html">awsrun.session</a></code></dt>
<dd>Contains the definition of the <code><a title="awsrun.session.SessionProvider" href="session/index.html#awsrun.session.SessionProvider">SessionProvider</a></code>, which is used
to provide Boto3 sessions pre-loaded with credentials. Included are several
built-in implementations such as <code><a title="awsrun.session.aws.CredsViaProfile" href="session/aws.html#awsrun.session.aws.CredsViaProfile">CredsViaProfile</a></code>,
<code><a title="awsrun.session.aws.CredsViaSAML" href="session/aws.html#awsrun.session.aws.CredsViaSAML">CredsViaSAML</a></code>, and <code><a title="awsrun.session.aws.CredsViaCrossAccount" href="session/aws.html#awsrun.session.aws.CredsViaCrossAccount">CredsViaCrossAccount</a></code>.
This module can be used outside of awsurn in other scripts. The module
documentation includes a user guide on how to do so.</dd>
</dl>
<h3 id="user-defined-commands">User-Defined Commands</h3>
<p>To get the most benefit from awsrun, one typically writes their own used-defined
commands. Please refer to the <code><a title="awsrun.commands" href="commands/index.html">awsrun.commands</a></code> page for an extensive user guide
on building commands. In summary, a command is nothing more than a single Python
file that contains a subclass of <code><a title="awsrun.runner.Command" href="runner.html#awsrun.runner.Command">Command</a></code>. After the command has
been written, it must be added to the awsrun command path using the <code>--cmd-path</code>
<a href="cli.html#options">CLI flag</a> or <code>cmd-path</code> option in the awsrun <a href="cli.html#configuration_1">configuration
file</a>.</p>
<h3 id="user-defined-plug-ins">User-Defined Plug-ins</h3>
<p>In addition to writing your own user-defined commands, you can write your own
account loader plug-ins as well as credential loader plug-ins. The following are
the high-level steps involved in writing your own plug-ins:</p>
<ol>
<li>
<p>Subclass <code><a title="awsrun.plugmgr.Plugin" href="plugmgr.html#awsrun.plugmgr.Plugin">Plugin</a></code>. Be sure to read the class and module
documentation for details on how the CLI loads your plug-in.</p>
</li>
<li>
<p>Add an <code>__init__</code> method to register command line flags and configuration
options you want to make available to the end user. Be sure to call the
superclass's <code>__init__</code> method as well.</p>
</li>
<li>
<p>Provide an implementation for <code><a title="awsrun.plugmgr.Plugin.instantiate" href="plugmgr.html#awsrun.plugmgr.Plugin.instantiate">Plugin.instantiate()</a></code>, which must
return an instance of either <code><a title="awsrun.acctload.AccountLoader" href="acctload.html#awsrun.acctload.AccountLoader">AccountLoader</a></code> or
<code><a title="awsrun.session.SessionProvider" href="session/index.html#awsrun.session.SessionProvider">SessionProvider</a></code> depending on whether you are writing an
account loader or a credential loader.</p>
</li>
<li>
<p>Provide an implementation for your account loader or credential loader
returned in step 3. Refer to the <code><a title="awsrun.acctload.AccountLoader" href="acctload.html#awsrun.acctload.AccountLoader">AccountLoader</a></code> and
<code><a title="awsrun.session.SessionProvider" href="session/index.html#awsrun.session.SessionProvider">SessionProvider</a></code> for the methods that must be implemented.</p>
</li>
</ol>
<p>It is recommended that you review the existing plug-ins included in awsrun for
additional guidance on how to build your own.</p>
<h2 id="future-plans">Future Plans</h2>
<p>Prior to open-sourcing awsrun, the codebase was refactored to support the use of
other cloud service providers. This section includes the implementation details
as well as a high-level roadmap of future enhancements.</p>
<h3 id="other-csps">Other CSPs</h3>
<p>Other Cloud Service Providers (CSPs) aside from AWS and Azure can be supported.
The name of the installed CLI script is used to determine which CSP is being
used. For example, if the CLI has been installed as <code><a title="awsrun" href="#awsrun">awsrun</a></code>, the CSP is <code>aws</code>.
If the CLI has been installed as <code>azurerun</code>, the CSP is <code>azure</code>. The name of the
CSP dictates the following:</p>
<ul>
<li>
<p>The user configuration file is loaded from <code>$HOME/.csprun.yaml</code>, where <code>csp</code>
is the name of the CSP. This allows users to have CSP-specific configuration
files.</p>
</li>
<li>
<p>The environment variable used to select an alternate path for the
configuration file is <code>CSPRUN_CONFIG</code>, where <code>CSP</code> is the name of the CSP.
This allows users to have multiple environment variables set for different
CSPs.</p>
</li>
<li>
<p>The default command path is set to <code>awsrun.commands.csp</code>, where <code>csp</code> is the
name of the CSP. All of the included CSP commands are isolated in modules
dedicated to the CSP. This prevents commands for a different CSP from being
displayed on the command line when a user lists the available commands.</p>
</li>
<li>
<p>The default credential loader plug-in is <code>awsrun.plugins.creds.csp.Default</code>,
where <code>csp</code> is the name of the CSP. Providing credentials to commands is done
via a credential loader. When none has been specified in the configuration
file, awsrun must default to a sane choice for a CSP.</p>
</li>
</ul>
<h3 id="roadmap">Roadmap</h3>
<ul>
<li>Add tests for each module (only a handful have been done so far). PyTest is
the framework used in awsrun. See the tests/ directory which contains the
directories for unit and integration tests.</li>
</ul>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#
# Copyright 2019 FMR LLC &lt;opensource@fmr.com&gt;
#
# SPDX-License-Identifier: MIT
#
&#34;&#34;&#34;CLI and library to concurrently execute user-defined commands across AWS accounts.

## Overview

`awsrun` is both a CLI and library to execute commands over one or more AWS
accounts concurrently. Commands are user-defined Python modules that implement a
simple interface to abstract away the complications of obtaining credentials for
Boto3 sessions - especially when using SAML authentication and/or cross-account
access.

### CLI Usage

The awsrun CLI command is documented extensively on the `awsrun.cli` page. It
includes both a user guide as well as a reference guide on the use of the CLI
command, its command line options, use of the account loader and credential
plug-ins, as well as the syntax of the configuration file.

### Library Usage

Not only is awsrun a CLI, but it is, first and foremost, a Python package that
can be used in other Python libraries and scripts. The package contains
extensive documentation on its use. Each submodule contains an overview of the
module and how to use it, which is then followed by standard module docs for
classes and methods. The available [submodules](#header-submodules) can be found
at the bottom of this page. Of particular interest to library users will be the
following submodules:

`awsrun.runner`
: The core module to execute a command across one or more accounts. You will
find the `awsrun.runner.AccountRunner` and `awsrun.runner.Command` classes
defined in this module. Build your own commands by subclassing the base class.
See the [User-Defined Commmands](#user-defined-commands) next for more
information.

`awsrun.session`
: Contains the definition of the `awsrun.session.SessionProvider`, which is used
to provide Boto3 sessions pre-loaded with credentials. Included are several
built-in implementations such as `awsrun.session.aws.CredsViaProfile`,
`awsrun.session.aws.CredsViaSAML`, and `awsrun.session.aws.CredsViaCrossAccount`.
This module can be used outside of awsurn in other scripts. The module
documentation includes a user guide on how to do so.

### User-Defined Commands

To get the most benefit from awsrun, one typically writes their own used-defined
commands. Please refer to the `awsrun.commands` page for an extensive user guide
on building commands. In summary, a command is nothing more than a single Python
file that contains a subclass of `awsrun.runner.Command`. After the command has
been written, it must be added to the awsrun command path using the `--cmd-path`
[CLI flag](cli.html#options) or `cmd-path` option in the awsrun [configuration
file](cli.html#configuration_1).

### User-Defined Plug-ins

In addition to writing your own user-defined commands, you can write your own
account loader plug-ins as well as credential loader plug-ins. The following are
the high-level steps involved in writing your own plug-ins:

1. Subclass `awsrun.plugmgr.Plugin`. Be sure to read the class and module
   documentation for details on how the CLI loads your plug-in.

2. Add an `__init__` method to register command line flags and configuration
   options you want to make available to the end user. Be sure to call the
   superclass&#39;s `__init__` method as well.

3. Provide an implementation for `awsrun.plugmgr.Plugin.instantiate`, which must
   return an instance of either `awsrun.acctload.AccountLoader` or
   `awsrun.session.SessionProvider` depending on whether you are writing an
   account loader or a credential loader.

4. Provide an implementation for your account loader or credential loader
   returned in step 3. Refer to the `awsrun.acctload.AccountLoader` and
   `awsrun.session.SessionProvider` for the methods that must be implemented.

It is recommended that you review the existing plug-ins included in awsrun for
additional guidance on how to build your own.

## Future Plans

Prior to open-sourcing awsrun, the codebase was refactored to support the use of
other cloud service providers. This section includes the implementation details
as well as a high-level roadmap of future enhancements.

### Other CSPs

Other Cloud Service Providers (CSPs) aside from AWS and Azure can be supported.
The name of the installed CLI script is used to determine which CSP is being
used. For example, if the CLI has been installed as `awsrun`, the CSP is `aws`.
If the CLI has been installed as `azurerun`, the CSP is `azure`. The name of the
CSP dictates the following:

- The user configuration file is loaded from `$HOME/.csprun.yaml`, where `csp`
  is the name of the CSP. This allows users to have CSP-specific configuration
files.

- The environment variable used to select an alternate path for the
  configuration file is `CSPRUN_CONFIG`, where `CSP` is the name of the CSP.
  This allows users to have multiple environment variables set for different
  CSPs.

- The default command path is set to `awsrun.commands.csp`, where `csp` is the
  name of the CSP. All of the included CSP commands are isolated in modules
  dedicated to the CSP. This prevents commands for a different CSP from being
  displayed on the command line when a user lists the available commands.

- The default credential loader plug-in is `awsrun.plugins.creds.csp.Default`,
  where `csp` is the name of the CSP. Providing credentials to commands is done
  via a credential loader. When none has been specified in the configuration
  file, awsrun must default to a sane choice for a CSP.

### Roadmap

- Add tests for each module (only a handful have been done so far). PyTest is
  the framework used in awsrun. See the tests/ directory which contains the
  directories for unit and integration tests.

&#34;&#34;&#34;

name = &#34;awsrun&#34;
__version__ = &#34;2.5.2&#34;</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="awsrun.acctload" href="acctload.html">awsrun.acctload</a></code></dt>
<dd>
<section class="desc"><p>Loads account objects and metadata for those accounts â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.argparse" href="argparse.html">awsrun.argparse</a></code></dt>
<dd>
<section class="desc"><p>Provides additional actions and formatters for the builtin argparse module.</p></section>
</dd>
<dt><code class="name"><a title="awsrun.cache" href="cache.html">awsrun.cache</a></code></dt>
<dd>
<section class="desc"><p>Provides the ability to cache single values â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.cli" href="cli.html">awsrun.cli</a></code></dt>
<dd>
<section class="desc"><p>The awsrun CLI concurrently executes commands across AWS accounts â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.cloudwatch" href="cloudwatch.html">awsrun.cloudwatch</a></code></dt>
<dd>
<section class="desc"><p>Provides a means of retrieving metrics from AWS CloudWatch â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.cmdmgr" href="cmdmgr.html">awsrun.cmdmgr</a></code></dt>
<dd>
<section class="desc"><p>Loads and instantiates user-defined awsrun commands â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.commands" href="commands/index.html">awsrun.commands</a></code></dt>
<dd>
<section class="desc"><p>Contains the built-in commands included in awsrun and azurerun â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.config" href="config.html">awsrun.config</a></code></dt>
<dd>
<section class="desc"><p>Provides a YAML/JSON config file reader with type-checked values â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.plugins" href="plugins/index.html">awsrun.plugins</a></code></dt>
<dd>
<section class="desc"><p>Plug-ins for the awsrun CLI â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.plugmgr" href="plugmgr.html">awsrun.plugmgr</a></code></dt>
<dd>
<section class="desc"><p>Loads and instantiates awsrun plug-ins for the CLI â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.runner" href="runner.html">awsrun.runner</a></code></dt>
<dd>
<section class="desc"><p>Executes a <code>Command</code> across one or more accounts concurrently â€¦</p></section>
</dd>
<dt><code class="name"><a title="awsrun.session" href="session/index.html">awsrun.session</a></code></dt>
<dd>
<section class="desc"><p>Obtain CSP sessions and credentials â€¦</p></section>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#overview">Overview</a><ul>
<li><a href="#cli-usage">CLI Usage</a></li>
<li><a href="#library-usage">Library Usage</a></li>
<li><a href="#user-defined-commands">User-Defined Commands</a></li>
<li><a href="#user-defined-plug-ins">User-Defined Plug-ins</a></li>
</ul>
</li>
<li><a href="#future-plans">Future Plans</a><ul>
<li><a href="#other-csps">Other CSPs</a></li>
<li><a href="#roadmap">Roadmap</a></li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="awsrun.acctload" href="acctload.html">awsrun.acctload</a></code></li>
<li><code><a title="awsrun.argparse" href="argparse.html">awsrun.argparse</a></code></li>
<li><code><a title="awsrun.cache" href="cache.html">awsrun.cache</a></code></li>
<li><code><a title="awsrun.cli" href="cli.html">awsrun.cli</a></code></li>
<li><code><a title="awsrun.cloudwatch" href="cloudwatch.html">awsrun.cloudwatch</a></code></li>
<li><code><a title="awsrun.cmdmgr" href="cmdmgr.html">awsrun.cmdmgr</a></code></li>
<li><code><a title="awsrun.commands" href="commands/index.html">awsrun.commands</a></code></li>
<li><code><a title="awsrun.config" href="config.html">awsrun.config</a></code></li>
<li><code><a title="awsrun.plugins" href="plugins/index.html">awsrun.plugins</a></code></li>
<li><code><a title="awsrun.plugmgr" href="plugmgr.html">awsrun.plugmgr</a></code></li>
<li><code><a title="awsrun.runner" href="runner.html">awsrun.runner</a></code></li>
<li><code><a title="awsrun.session" href="session/index.html">awsrun.session</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>