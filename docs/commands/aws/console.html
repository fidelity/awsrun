<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.11.1" />
<title>awsrun.commands.aws.console API documentation</title>
<meta name="description" content="Obtain a sign-in URL for the AWS Console â€¦" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css" rel="stylesheet">
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<!-- <link href="/awsrun/webfonts.css" rel="stylesheet"> -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Roboto:ital,wght@0,300;0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
<style>
body {
font-size: 16px;
font-family: 'Roboto', sans-serif;
}
code {
font-family: 'Roboto Mono', monospace;
}
#content {
max-width: 100ch;
}
/* `Text` size and code in main body text */
section code {
font-size: 14px;
}
/* Line height for blocks of code in main text */
pre code {
font-size: 13px;
line-height: 1.35em;
}
/* "expand source code" text */
details {
font-size: 12px;
}
/* Code block in the expand source section */
.source pre code {
font-size: 12px;
line-height: 1.35em;
}
/* Navbar */
#sidebar code {
font-size: 13px;
}
#sidebar .toc {
font-size: 15px;
}
#sidebar h1 { font-size: 1.4em; }
#sidebar h3 { font-size: 1.10em; }
/* Used in method names sections etc .. */
code.name {
font-size: 14px;
}
.title code {
font-family: 'Roboto', sans-serif;
}
dt {
font-weight: bold;
}
h1 {
font-size: 2.0em;
}
</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>awsrun.commands.aws.console</code></h1>
</header>
<section id="section-intro">
<p>Obtain a sign-in URL for the AWS Console.</p>
<h2 id="overview">Overview</h2>
<p>Generates a sign-in URL for the AWS Console using the STS credentials obtained
from awsrun credential provider. This command is only useful for those using
SAML federation with AWS.</p>
<p>The URL returned is only valid for 15 minutes. The session duration for the URL
can be adjusted via the awsrun credential plug-in parameter <code>--saml-duration</code>
and <code>--x-acct-duration</code> flags depending on which mechanism is being used to
authenticate.</p>
<p>Use the <code>--region</code> option to specify a region for the console login. To specify
an exact landing page, a <code>--path</code> can be provided as well. For example, to land on
the routing table page in us-west-2:</p>
<pre><code>$ awsrun --account 100200300400 console --region us-west-2 --path "/vpc/home#RouteTables:sort=routeTableId"
</code></pre>
<h2 id="reference">Reference</h2>
<h3 id="synopsis">Synopsis</h3>
<pre><code>$ awsrun [options] console [command options]
</code></pre>
<h3 id="configuration">Configuration</h3>
<p>The following is the syntax for the options that can be specified in the user
configuration file:</p>
<pre><code>Commands:
  console:
    path: URL_PATH
    region:
      - STRING
</code></pre>
<h3 id="command-options">Command Options</h3>
<p>Some options can be overridden on the awsrun CLI via command line flags. In
those cases, the CLI flags are specified next to the option name below:</p>
<dl>
<dt><code>region</code>, <code>--region REGION</code></dt>
<dd>Run the command in the specified regions. When specifying multiple values on
the command line, use multiple flags for each value. There is no default value.</dd>
<dt><code>path</code>, <code>--path URL_PATH</code></dt>
<dd>Specify the URL path within the AWS Console to embed within the sign-in URL.
The default value is <code>/console/home</code>.</dd>
</dl>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">#
# Copyright 2019 FMR LLC &lt;opensource@fidelity.com&gt;
#
# SPDX-License-Identifier: Apache-2.0
#
&#34;&#34;&#34;Obtain a sign-in URL for the AWS Console.

## Overview

Generates a sign-in URL for the AWS Console using the STS credentials obtained
from awsrun credential provider. This command is only useful for those using
SAML federation with AWS.

The URL returned is only valid for 15 minutes. The session duration for the URL
can be adjusted via the awsrun credential plug-in parameter `--saml-duration`
and `--x-acct-duration` flags depending on which mechanism is being used to
authenticate.

Use the `--region` option to specify a region for the console login. To specify
an exact landing page, a `--path` can be provided as well. For example, to land on
the routing table page in us-west-2:

    $ awsrun --account 100200300400 console --region us-west-2 --path &#34;/vpc/home#RouteTables:sort=routeTableId&#34;

## Reference

### Synopsis

    $ awsrun [options] console [command options]

### Configuration

The following is the syntax for the options that can be specified in the user
configuration file:

    Commands:
      console:
        path: URL_PATH
        region:
          - STRING

### Command Options
Some options can be overridden on the awsrun CLI via command line flags. In
those cases, the CLI flags are specified next to the option name below:

`region`, `--region REGION`
: Run the command in the specified regions. When specifying multiple values on
the command line, use multiple flags for each value. There is no default value.

`path`, `--path URL_PATH`
: Specify the URL path within the AWS Console to embed within the sign-in URL.
The default value is `/console/home`.
&#34;&#34;&#34;

import json

import requests

from awsrun.runner import Command


class CLICommand(Command):
    &#34;&#34;&#34;Obtain a signin URL for the AWS Console&#34;&#34;&#34;

    @classmethod
    def from_cli(cls, parser, argv, cfg):
        parser.add_argument(
            &#34;--region&#34;,
            default=cfg(&#34;region&#34;, default=&#34;us-east-1&#34;),
            help=&#34;generate URL for REGION&#34;,
        )
        parser.add_argument(
            &#34;--path&#34;,
            default=cfg(&#34;path&#34;, default=&#34;/console/home&#34;),
            help=&#34;Optional path to append to AWS url&#34;,
        )
        args = parser.parse_args(argv)
        return cls(**vars(args))

    def __init__(self, region, path):
        self.region = region
        self.path = path

    def execute(self, session, acct):
        creds = session.get_credentials()

        try:
            session_creds = {}
            session_creds[&#34;sessionId&#34;] = creds.access_key
            session_creds[&#34;sessionKey&#34;] = creds.secret_key
            session_creds[&#34;sessionToken&#34;] = creds.token
        except AttributeError:
            return f&#34;{acct}: can only be used with federated auth types&#34;

        # Retrieve a signin token from AWS federation service
        r = requests.get(
            &#34;https://signin.aws.amazon.com/federation&#34;,
            params={&#34;Action&#34;: &#34;getSigninToken&#34;, &#34;Session&#34;: json.dumps(session_creds)},
            timeout=10.0,
        )
        r.raise_for_status()
        signin_token = r.json()[&#34;SigninToken&#34;]

        # Use Request to create well-formed URL that we return to user
        r = requests.Request(
            &#34;GET&#34;,
            &#34;https://signin.aws.amazon.com/federation&#34;,
            params={
                &#34;Action&#34;: &#34;login&#34;,
                &#34;Issuer&#34;: &#34;fmr.com&#34;,
                &#34;Destination&#34;: f&#34;https://console.aws.amazon.com{self.path}?region={self.region}&#34;,
                &#34;SigninToken&#34;: signin_token,
            },
        )

        return f&#34;{acct}: {r.prepare().url}\n&#34;</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="awsrun.commands.aws.console.CLICommand"><code class="flex name class">
<span>class <span class="ident">CLICommand</span></span>
<span>(</span><span>region, path)</span>
</code></dt>
<dd>
<section class="desc"><p>Obtain a signin URL for the AWS Console</p></section>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CLICommand(Command):
    &#34;&#34;&#34;Obtain a signin URL for the AWS Console&#34;&#34;&#34;

    @classmethod
    def from_cli(cls, parser, argv, cfg):
        parser.add_argument(
            &#34;--region&#34;,
            default=cfg(&#34;region&#34;, default=&#34;us-east-1&#34;),
            help=&#34;generate URL for REGION&#34;,
        )
        parser.add_argument(
            &#34;--path&#34;,
            default=cfg(&#34;path&#34;, default=&#34;/console/home&#34;),
            help=&#34;Optional path to append to AWS url&#34;,
        )
        args = parser.parse_args(argv)
        return cls(**vars(args))

    def __init__(self, region, path):
        self.region = region
        self.path = path

    def execute(self, session, acct):
        creds = session.get_credentials()

        try:
            session_creds = {}
            session_creds[&#34;sessionId&#34;] = creds.access_key
            session_creds[&#34;sessionKey&#34;] = creds.secret_key
            session_creds[&#34;sessionToken&#34;] = creds.token
        except AttributeError:
            return f&#34;{acct}: can only be used with federated auth types&#34;

        # Retrieve a signin token from AWS federation service
        r = requests.get(
            &#34;https://signin.aws.amazon.com/federation&#34;,
            params={&#34;Action&#34;: &#34;getSigninToken&#34;, &#34;Session&#34;: json.dumps(session_creds)},
            timeout=10.0,
        )
        r.raise_for_status()
        signin_token = r.json()[&#34;SigninToken&#34;]

        # Use Request to create well-formed URL that we return to user
        r = requests.Request(
            &#34;GET&#34;,
            &#34;https://signin.aws.amazon.com/federation&#34;,
            params={
                &#34;Action&#34;: &#34;login&#34;,
                &#34;Issuer&#34;: &#34;fmr.com&#34;,
                &#34;Destination&#34;: f&#34;https://console.aws.amazon.com{self.path}?region={self.region}&#34;,
                &#34;SigninToken&#34;: signin_token,
            },
        )

        return f&#34;{acct}: {r.prepare().url}\n&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<code><li><a title="awsrun.runner.Command" href="../../runner.html#awsrun.runner.Command">Command</a></li></code>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="awsrun.runner.Command" href="../../runner.html#awsrun.runner.Command">Command</a></b></code>:
<ul class="hlist">
<li><code><a title="awsrun.runner.Command.collect_results" href="../../runner.html#awsrun.runner.Command.collect_results">collect_results</a></code></li>
<li><code><a title="awsrun.runner.Command.execute" href="../../runner.html#awsrun.runner.Command.execute">execute</a></code></li>
<li><code><a title="awsrun.runner.Command.from_cli" href="../../runner.html#awsrun.runner.Command.from_cli">from_cli</a></code></li>
<li><code><a title="awsrun.runner.Command.post_hook" href="../../runner.html#awsrun.runner.Command.post_hook">post_hook</a></code></li>
<li><code><a title="awsrun.runner.Command.pre_hook" href="../../runner.html#awsrun.runner.Command.pre_hook">pre_hook</a></code></li>
<li><code><a title="awsrun.runner.Command.pre_hook_with_context" href="../../runner.html#awsrun.runner.Command.pre_hook_with_context">pre_hook_with_context</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#reference">Reference</a><ul>
<li><a href="#synopsis">Synopsis</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#command-options">Command Options</a></li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="awsrun.commands.aws" href="index.html">awsrun.commands.aws</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="awsrun.commands.aws.console.CLICommand" href="#awsrun.commands.aws.console.CLICommand">CLICommand</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>
